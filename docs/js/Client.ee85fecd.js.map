{"version":3,"sources":["webpack:///./src/views/Client.vue?75f5","webpack:///src/views/Client.vue","webpack:///./src/views/Client.vue?3cc3","webpack:///./src/views/Client.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","logs","_l","paginated","log","index","key","accountId","imgurl","_s","client","nameLimit","staff","category","roll","email","tell","_e","staticRenderFns","components","Header","SideBar","data","localStorage","paginate","created","clientImgArray","sort","allFunction","methods","text","substr","maxLength","component"],"mappings":"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","file":"js/Client.ee85fecd.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Header'),_c('div',{staticClass:\"container\"},[_c('SideBar'),_c('main',[_c('section',{staticClass:\"client-section\"},[_c('h2',[_vm._v(\"クライアント一覧\")]),_c('paginate',{staticClass:\"paginate\",attrs:{\"name\":\"paginate-log\",\"list\":_vm.logs,\"per\":10,\"tag\":\"div\"}},_vm._l((_vm.paginated('paginate-log')),function(log,index){return _c('article',{key:index,staticClass:\"client-box\"},[_c('router-link',{staticClass:\"client-link-box\",attrs:{\"to\":'/client/detail/' + log.accountId,\"tag\":\"div\"}},[_c('div',{staticClass:\"img-box\"},[(log.imgurl)?_c('img',{attrs:{\"src\":log.imgurl,\"alt\":\"クライアントの画像\"}}):_c('img',{attrs:{\"src\":require(\"../assets/image/no_image.png\"),\"alt\":\"クライアントの画像\"}})]),_c('div',{staticClass:\"client-info\"},[_c('div',{staticClass:\"client-name-info\"},[_c('h3',{staticClass:\"client-name\"},[_vm._v(_vm._s(log.client ? _vm.nameLimit(log.client) : _vm.nameLimit('未設定')))]),_c('p',{staticClass:\"client-staff\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"担当: \")]),_vm._v(_vm._s(log.staff ? log.staff : '未設定'))])]),_c('div',{staticClass:\"category\"},_vm._l((log.category),function(category,index){return _c('p',{key:index,staticClass:\"client-category\"},[_vm._v(_vm._s(category ? category : '未設定'))])}),0),(_vm.roll === 'admin')?_c('div',{staticClass:\"inquiry\"},[_c('p',{staticClass:\"email\"},[_vm._v(_vm._s(log.email ? log.email : '未設定'))]),_c('p',{staticClass:\"tell\"},[_vm._v(_vm._s(log.tell ? log.tell : '未設定'))])]):_vm._e()])])],1)}),0)],1),_c('paginate-links',{attrs:{\"for\":\"paginate-log\",\"limit\":10,\"classes\":{\n          'ul': 'pagination',\n          'li': 'pagination-list',\n          'li > a': 'pagination-link'\n        },\"show-step-links\":true}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <Header/>\n    <div class=\"container\">\n      <SideBar/>\n      <main>\n        <section class=\"client-section\">\n          <h2>クライアント一覧</h2>\n        \n          <paginate class=\"paginate\" name=\"paginate-log\" :list=\"logs\" :per=\"10\" tag=\"div\">\n            <article class=\"client-box\" v-for=\"(log, index) in paginated('paginate-log')\" :key=\"index\">\n              <router-link :to=\"'/client/detail/' + log.accountId\" tag=\"div\" class=\"client-link-box\">\n                <div class=\"img-box\">\n                  <img v-if=\"log.imgurl\" :src=\"log.imgurl\" alt=\"クライアントの画像\">\n                  <img v-else src=\"../assets/image/no_image.png\" alt=\"クライアントの画像\">\n                </div>\n                <div class=\"client-info\">\n                  <div class=\"client-name-info\">\n                    <h3 class=\"client-name\">{{ log.client ? nameLimit(log.client) : nameLimit('未設定') }}</h3>\n                    <p class=\"client-staff\"><span class=\"title\">担当: </span>{{ log.staff ? log.staff : '未設定' }}</p>\n                  </div>\n                  <div class=\"category\">\n                    <p class=\"client-category\" v-for=\"(category, index) in log.category\" :key=\"index\">{{ category ? category : '未設定' }}</p>\n                  </div>\n                  <div v-if=\"roll === 'admin'\" class=\"inquiry\">\n                    <p class=\"email\">{{ log.email ? log.email : '未設定' }}</p>\n                    <p class=\"tell\">{{ log.tell ? log.tell : '未設定' }}</p>\n                  </div>\n                </div>\n              </router-link>\n            </article>\n          </paginate>\n        </section>\n        <paginate-links \n          for=\"paginate-log\" \n          :limit=\"10\"\n          :classes=\"{\n            'ul': 'pagination',\n            'li': 'pagination-list',\n            'li > a': 'pagination-link'\n          }\" \n          :show-step-links=\"true\"\n        ></paginate-links>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Header from '../components/Header.vue';\nimport SideBar from '../components/SideBar.vue';\nimport firebase from '@/plugins/firebase'\n\nexport default {\n  components: {\n    Header,\n    SideBar\n  },\n  data() {\n    return {\n      roll: localStorage.roll,\n      logs: [],\n      paginate: ['paginate-log'],\n    }\n  },\n  created() {\n    const accountDb = firebase.firestore().collection('account')\n\n    // (2) 全てのクライアントを取得して、データのみ配列に格納する処理\n    const getClient = async () => {\n      const clientsDataArray = [];\n      const clients = await accountDb.where('roll', '==', 'client').get();\n      clients.forEach(client => {\n        clientsDataArray.push(client.data());\n      })\n      return clientsDataArray;\n    }\n\n    // (3) imgpathがあればimgurlを取得し、なければそのまま格納する処理\n    const pushLogs = async (clientsDataArray) => {\n      const clientImgArray = [];\n      for(let i = 0; i < clientsDataArray.length; i++) {\n        if(clientsDataArray[i].imgpath !== '') {\n          const imgpath = clientsDataArray[i].imgpath;\n          const imgurl = await firebase.storage().ref().child(imgpath).getDownloadURL();\n          clientsDataArray[i].imgurl = imgurl;\n          clientImgArray.push(clientsDataArray[i]);\n        } else {\n          clientImgArray.push(clientsDataArray[i]);\n        }\n      }\n      return clientImgArray;\n    }\n\n    // (4) logsのデータを降順にソートする処理\n    const clientSort = (clientImgArray) => {\n      clientImgArray.sort((to, from) => {\n        if(to.date > from.date) return -1;\n        if(to.date < from.date) return 1;\n        return 0;\n      })\n      this.logs = clientImgArray;\n    }\n\n    // (1) 全ての関数を実行\n    const allFunction = async () => {\n      const clientsDataArray = await getClient()\n      const clientImgArray = await pushLogs(clientsDataArray)\n      await clientSort(clientImgArray)\n    }\n\n    allFunction()\n\n  },\n  methods: {\n    nameLimit(text) {\n      const maxLength = 8;\n      if(text.length > maxLength) {\n        return text.substr(0, maxLength) + '...';\n      }\n      return text;\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Client.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Client.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Client.vue?vue&type=template&id=271a5668&\"\nimport script from \"./Client.vue?vue&type=script&lang=js&\"\nexport * from \"./Client.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}